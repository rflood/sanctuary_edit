//jQuery Parallax
//Author: Ian Lunn
function RepositionNav(){var d=$(window).height();var c=$("#slide-nav").height()/2;var b=(d/2);var a=b-c;$("#slide-nav").css({top:a})}(function(a){a.fn.parallax=function(f,e,g,l){function k(n,m){m.each(function(){var p=a(this);var q=p.offset().top;if(l==true){var o=p.outerHeight(true)}else{var o=p.height()}if(q+o>=n&&q+o-b<n){d(n,o)}if(q<=n&&(q+o)>=n&&(q-b)<n&&q+o-b>n){d(n,o)}if(q+o>n&&q-b<n&&q>n){d(n,o)}})}var c=a(window);var b=a(window).height();var j=c.scrollTop();var i=a(this);if(f==null){f="50%"}if(e==null){e=0}if(g==null){g=0.1}if(l==null){l=true}height=i.height();i.css({backgroundPosition:h(f,l,e,g)});function h(o,q,p,n,m){return o+" "+Math.round((-((q+p)-n)*m))+"px"}function d(n,m){i.css({backgroundPosition:h(f,m,n,e,g)})}c.bind("scroll",function(){var m=c.scrollTop();k(m,i);a("#pixels").html(m)})}})(jQuery);

//jQuery ScrollTo
//Author: Ariel Flesler
;(function(d){var k=d.scrollTo=function(a,i,e){d(window).scrollTo(a,i,e)};k.defaults={axis:'xy',duration:parseFloat(d.fn.jquery)>=1.3?0:1};k.window=function(a){return d(window)._scrollable()};d.fn._scrollable=function(){return this.map(function(){var a=this,i=!a.nodeName||d.inArray(a.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!i)return a;var e=(a.contentWindow||a).document||a.ownerDocument||a;return d.browser.safari||e.compatMode=='BackCompat'?e.body:e.documentElement})};d.fn.scrollTo=function(n,j,b){if(typeof j=='object'){b=j;j=0}if(typeof b=='function')b={onAfter:b};if(n=='max')n=9e9;b=d.extend({},k.defaults,b);j=j||b.speed||b.duration;b.queue=b.queue&&b.axis.length>1;if(b.queue)j/=2;b.offset=p(b.offset);b.over=p(b.over);return this._scrollable().each(function(){var q=this,r=d(q),f=n,s,g={},u=r.is('html,body');switch(typeof f){case'number':case'string':if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(f)){f=p(f);break}f=d(f,this);case'object':if(f.is||f.style)s=(f=d(f)).offset()}d.each(b.axis.split(''),function(a,i){var e=i=='x'?'Left':'Top',h=e.toLowerCase(),c='scroll'+e,l=q[c],m=k.max(q,i);if(s){g[c]=s[h]+(u?0:l-r.offset()[h]);if(b.margin){g[c]-=parseInt(f.css('margin'+e))||0;g[c]-=parseInt(f.css('border'+e+'Width'))||0}g[c]+=b.offset[h]||0;if(b.over[h])g[c]+=f[i=='x'?'width':'height']()*b.over[h]}else{var o=f[h];g[c]=o.slice&&o.slice(-1)=='%'?parseFloat(o)/100*m:o}if(/^\d+$/.test(g[c]))g[c]=g[c]<=0?0:Math.min(g[c],m);if(!a&&b.queue){if(l!=g[c])t(b.onAfterFirst);delete g[c]}});t(b.onAfter);function t(a){r.animate(g,j,b.easing,a&&function(){a.call(this,n,b)})}}).end()};k.max=function(a,i){var e=i=='x'?'Width':'Height',h='scroll'+e;if(!d(a).is('html,body'))return a[h]-d(a)[e.toLowerCase()]();var c='client'+e,l=a.ownerDocument.documentElement,m=a.ownerDocument.body;return Math.max(l[h],m[h])-Math.min(l[c],m[c])};function p(a){return typeof a=='object'?a:{top:a,left:a}}})(jQuery);

//jQuery Scrollorama
//Author: John Polacek
(function(a){a.scrollorama=function(k){var b=[],g="",i=function(){};var c=this;var f={offset:0};c.settings=a.extend({},f,k);c.blockIndex=0;if(k.blocks===undefined){alert("ERROR: Must assign blocks class selector to scrollorama plugin")}function j(){if(typeof c.settings.blocks==="string"){c.settings.blocks=a(c.settings.blocks)}if(a.browser.mozilla){g="-moz-"}if(a.browser.webkit){g="-webkit-"}if(a.browser.opera){g="-o-"}if(a.browser.msie){g="-ms-"}a("body").css("position","relative");var l;for(l=0;l<c.settings.blocks.length;l++){var n=c.settings.blocks.eq(l);b.push({block:n,top:n.offset().top,pin:0,animations:[]})}for(l=0;l<b.length;l++){b[l].block.css("position","absolute").css("top",b[l].top)}a("body").prepend("<div id='scroll-wrap'></div>");var m=false;a(window).scroll(function(){m=true});setInterval(function(){if(m){e();m=false}},50)}function e(){var m=a(window).scrollTop();var s=h(m);for(var q=0;q<b.length;q++){if(b[q].animations.length){for(var p=0;p<b[q].animations.length;p++){var o=b[q].animations[p];if(q>s){if(s!=q-1&&o.baseline!="bottom"){d(o.element,o.property,o.startVal)}if(b[q].pin){b[q].block.css("position","absolute").css("top",b[q].top)}}else{if(q<s){d(o.element,o.property,o.endVal);if(b[q].pin){b[q].block.css("position","absolute").css("top",(b[q].top+b[q].pin))}}}if(q==s||(s==q-1&&o.baseline=="bottom")){if(b[q].pin&&s==q){b[q].block.css("position","fixed").css("top",0)}var t=b[q].top+o.delay;if(o.baseline=="bottom"){t-=a(window).height()}var n=t+o.duration;if(m<t){d(o.element,o.property,o.startVal)}else{if(m>n){d(o.element,o.property,o.endVal);if(b[q].pin){b[q].block.css("position","absolute").css("top",(b[q].top+b[q].pin))}}else{var r=(m-t)/o.duration;var l=o.startVal+(r*(o.endVal-o.startVal));d(o.element,o.property,l)}}}}}}if(c.blockIndex!=s){c.blockIndex=s;i()}}function h(n){var m=0;for(var l=0;l<b.length;l++){if(b[l].top<=n-c.settings.offset){m=l}}return m}function d(m,o,n){if(o==="rotate"||o==="zoom"||o==="scale"){if(o==="rotate"){m.css(g+"transform","rotate("+n+"deg)")}else{if(o==="zoom"||o==="scale"){var l="scale("+n+")";if(g!=="-ms-"){m.css(g+"transform",l)}else{m.css("zoom",l)}}}}else{m.css(o,n)}}c.animate=function(q){if(typeof q==="string"){q=a(q)}var l;var p;for(var n=0;n<b.length;n++){if(b[n].block.has(q).length){p=b[n];l=n}}for(n=1;n<arguments.length;n++){var o=arguments[n];if(o.property=="top"||o.property=="left"||o.property=="bottom"||o.property=="right"){if(q.css("position")=="static"){q.css("position","relative")}if(o.start===undefined){o.start=0}else{if(o.end===undefined){o.end=0}}}if(o.property=="rotate"){if(o.start===undefined){o.start=0}if(o.end===undefined){o.end=0}}else{if(o.property=="zoom"||o.property=="scale"){if(o.start===undefined){o.start=1}if(o.end===undefined){o.end=1}}else{if(o.property=="letter-spacing"&&q.css(o.property)){if(o.start===undefined){o.start=1}if(o.end===undefined){o.end=1}}}}if(o.baseline===undefined){if(o.pin||p.pin||l===0){o.baseline="top"}else{o.baseline="bottom"}}if(o.delay===undefined){o.delay=0}p.animations.push({element:q,delay:o.delay,duration:o.duration,property:o.property,startVal:o.start!==undefined?o.start:parseInt(q.css(o.property),10),endVal:o.end!==undefined?o.end:parseInt(q.css(o.property),10),baseline:o.baseline!==undefined?o.baseline:"bottom"});if(o.pin){if(p.pin<o.duration+o.delay){var r=o.duration+o.delay-p.pin;p.pin+=r;for(var m=l+1;m<b.length;m++){b[m].top+=r;b[m].block.css("top",b[m].top)}}}}e()};c.onBlockChange=function(l){i=l};c.getScrollpoints=function(){var l=[];for(var n=0;n<b.length;n++){l.push(b[n].top);if(b[n].animations.length&&b[n].pin>0){for(var m=0;m<b[n].animations.length;m++){var o=b[n].animations[m];l.push(b[n].top+o.delay+o.duration)}}}l.sort(function(q,p){return q-p});return l};j();return c}})(jQuery);

//jQuery Scrolldeck
//Author: John Polacek
(function(a){a.scrolldeck=function(r){var d=0,n,e,q=[],o=[],c=a(window).height(),h;var g={buttons:".nav-button",slides:".slide",duration:600,easing:"easeInOutExpo",offset:0};var k=this;k.settings={};var p=function(){a("html, body").animate({scrollTop:0});k.settings=a.extend({},g,r);n=a(k.settings.buttons);e=a(k.settings.slides);k.controller=a.scrollorama({blocks:e,offset:k.settings.offset});for(h=0;h<a(".animate-in").length;h++){var t=a(".animate-in").eq(h);switch(t.attr("data-animation")){case"fly-in-left":t.parent().css("overflow","hidden");k.controller.animate(t,{delay:c/2,duration:c/2,property:"left",start:-1200});break;case"fly-in-right":t.parent().css("overflow","hidden");k.controller.animate(t,{delay:c/2,duration:c/2,property:"right",start:-1200});break;case"space-in":k.controller.animate(t,{delay:c*0.8,duration:c*0.2,property:"letter-spacing",start:40});k.controller.animate(t,{delay:c*0.8,duration:c*0.2,property:"opacity",start:0});break;case"fade-in":k.controller.animate(t,{delay:c/2,duration:c/2,property:"opacity",start:0});default:k.controller.animate(t,{delay:c/2,duration:c/2,property:"opacity",start:0})}}for(h=0;h<a(".animate-build").length;h++){var t=a(".animate-build").eq(h);switch(t.attr("data-animation")){case"fly-in-left":t.parent().css("overflow","hidden");k.controller.animate(t,{delay:(t.attr("data-build")-1)*400,duration:400,property:"left",start:-1200,pin:true});break;case"fly-in-right":t.parent().css("overflow","hidden");k.controller.animate(t,{delay:(t.attr("data-build")-1)*400,duration:400,property:"right",start:-1200,pin:true});break;case"space-in":k.controller.animate(t,{delay:(t.attr("data-build")-1)*400,duration:400,property:"letter-spacing",start:40,pin:true});k.controller.animate(t,{delay:(t.attr("data-build")-1)*400,duration:400,property:"opacity",start:0,pin:true});break;case"fade-in":k.controller.animate(t,{delay:(t.attr("data-build")-1)*400,duration:400,property:"opacity",start:0,pin:true});default:k.controller.animate(t,{delay:(t.attr("data-build")-1)*400,duration:400,property:"opacity",start:0,pin:true})}}q=k.controller.getScrollpoints();for(h=0;h<n.length;h++){o.push(e.index(a(a(n[h]).attr("href"))))}k.controller.onBlockChange(function(){d=k.controller.blockIndex;f()});n.click(function(v){v.preventDefault();var u=a(a(this).attr("href"));d=u.index();j(u)});a(document).keydown(function(u){if((u.keyCode==37)&&d!==0){j(b())}else{if((u.keyCode==39||u.keyCode==32)&&d!=e.length-1){j(m())}}});for(h=0;h<e.length;h++){var i=e.eq(h);if(i.prop("tagName").toUpperCase()==="IMG"){i.css("height","auto")}}var s=e.eq(e.length-1);if(s.outerHeight()<a(window).height()){s.height(s.height()+a(window).height()-s.outerHeight())}f()};function f(){if(n){n.removeClass("current");var i=-1;for(h=0;h<o.length;h++){if(d>=o[h]){i=h}}if(i!=-1){n.eq(i).addClass("current")}}}function j(i){a(window)._scrollable().stop();a(window).scrollTo(i,{duration:k.settings.duration,easing:k.settings.easing,offset:k.settings.offset})}function m(){return l(2)}function b(){return l(-1)}function l(t){var s=a(window).scrollTop();var i=q.slice(0);i.push(s);i.sort(function(v,u){return v-u});return i[i.indexOf(s)+t]}p()}})(jQuery);


$(document).ready(function() {
    if ($("html").hasClass("no-touch")) {
		$('.group1').parallax("50%", 0, 0.1, true);
		$('.group2').parallax("50%", 1200, 0.1, true);
		$('.group3').parallax("50%", 3130, 0.1, true);
		$('.group4').parallax("50%", 5060, 0.1, true);
        $('.group5').parallax("50%", 6990, 0.1, true);
		
		var deck = new $.scrolldeck({
			slides: '.slide',
			buttons: '#slide-nav li a',
			duration: 900,
			easing: 'easeInOutExpo'
		});
		//position home captions
		function posCaptions() {
			$windowHeight = $(window).height();
			$caption = $('.home-caption').outerHeight();
			$('.home-caption').css('marginTop', ($windowHeight/2 + 135));
		}
		posCaptions();
		$(window).resize(function() {
			posCaptions();
		});		
    }
});
